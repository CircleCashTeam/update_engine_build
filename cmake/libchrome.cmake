include(CheckCSourceCompiles)

set(CMAKE_CXX_EXTENSIONS OFF)

set(target chrome)
set(target_dir "${CMAKE_SOURCE_DIR}/platform/external/libchrome")

set(libchrome_include_sources
        "${target_dir}/base/allocator/allocator_extension.h"
        "${target_dir}/base/allocator/allocator_shim.h"
        "${target_dir}/base/allocator/allocator_shim_internals.h"
        "${target_dir}/base/allocator/allocator_shim_override_cpp_symbols.h"
        "${target_dir}/base/allocator/allocator_shim_override_libc_symbols.h"
        "${target_dir}/base/allocator/allocator_shim_override_linker_wrapped_symbols.h"
        "${target_dir}/base/allocator/buildflags.h"
        "${target_dir}/base/android/android_hardware_buffer_compat.h"
        "${target_dir}/base/android/build_info.h"
        "${target_dir}/base/android/content_uri_utils.h"
        "${target_dir}/base/android/java_exception_reporter.h"
        "${target_dir}/base/android/jni_android.h"
        "${target_dir}/base/android/jni_array.h"
        "${target_dir}/base/android/jni_string.h"
        "${target_dir}/base/android/path_utils.h"
        "${target_dir}/base/android/scoped_hardware_buffer_handle.h"
        "${target_dir}/base/android/scoped_java_ref.h"
        "${target_dir}/base/android/sys_utils.h"
        "${target_dir}/base/at_exit.h"
        "${target_dir}/base/atomic_ref_count.h"
        "${target_dir}/base/atomic_sequence_num.h"
        "${target_dir}/base/atomicops.h"
        "${target_dir}/base/atomicops_internals_atomicword_compat.h"
        "${target_dir}/base/atomicops_internals_portable.h"
        "${target_dir}/base/atomicops_internals_x86_msvc.h"
        "${target_dir}/base/auto_reset.h"
        "${target_dir}/base/barrier_closure.h"
        "${target_dir}/base/base64.h"
        "${target_dir}/base/base64url.h"
        "${target_dir}/base/base_export.h"
        "${target_dir}/base/base_paths.h"
        "${target_dir}/base/base_paths_android.h"
        "${target_dir}/base/base_paths_posix.h"
        "${target_dir}/base/base_switches.h"
        "${target_dir}/base/big_endian.h"
        "${target_dir}/base/bind.h"
        "${target_dir}/base/bind_helpers.h"
        "${target_dir}/base/bind_internal.h"
        "${target_dir}/base/bit_cast.h"
        "${target_dir}/base/bits.h"
        "${target_dir}/base/build_time.h"
        "${target_dir}/base/callback.h"
        "${target_dir}/base/callback_forward.h"
        "${target_dir}/base/callback_helpers.h"
        "${target_dir}/base/callback_internal.h"
        "${target_dir}/base/callback_list.h"
        "${target_dir}/base/cancelable_callback.h"
        "${target_dir}/base/cfi_buildflags.h"
        "${target_dir}/base/command_line.h"
        "${target_dir}/base/compiler_specific.h"
        "${target_dir}/base/component_export.h"
        "${target_dir}/base/containers/adapters.h"
        "${target_dir}/base/containers/circular_deque.h"
        "${target_dir}/base/containers/flat_map.h"
        "${target_dir}/base/containers/flat_set.h"
        "${target_dir}/base/containers/flat_tree.h"
        "${target_dir}/base/containers/hash_tables.h"
        "${target_dir}/base/containers/linked_list.h"
        "${target_dir}/base/containers/mru_cache.h"
        "${target_dir}/base/containers/queue.h"
        "${target_dir}/base/containers/ring_buffer.h"
        "${target_dir}/base/containers/small_map.h"
        "${target_dir}/base/containers/span.h"
        "${target_dir}/base/containers/stack.h"
        "${target_dir}/base/containers/stack_container.h"
        "${target_dir}/base/containers/vector_buffer.h"
        "${target_dir}/base/cpu.h"
        "${target_dir}/base/critical_closure.h"
        "${target_dir}/base/debug/activity_tracker.h"
        "${target_dir}/base/debug/alias.h"
        "${target_dir}/base/debug/crash_logging.h"
        "${target_dir}/base/debug/debugger.h"
        "${target_dir}/base/debug/debugging_buildflags.h"
        "${target_dir}/base/debug/dump_without_crashing.h"
        "${target_dir}/base/debug/elf_reader_linux.h"
        "${target_dir}/base/debug/leak_annotations.h"
        "${target_dir}/base/debug/leak_tracker.h"
        "${target_dir}/base/debug/proc_maps_linux.h"
        "${target_dir}/base/debug/profiler.h"
        "${target_dir}/base/debug/stack_trace.h"
        "${target_dir}/base/debug/task_annotator.h"
        "${target_dir}/base/debug/thread_heap_usage_tracker.h"
        "${target_dir}/base/environment.h"
        "${target_dir}/base/export_template.h"
        "${target_dir}/base/feature_list.h"
        "${target_dir}/base/file_descriptor_posix.h"
        "${target_dir}/base/file_version_info.h"
        "${target_dir}/base/files/dir_reader_fallback.h"
        "${target_dir}/base/files/dir_reader_linux.h"
        "${target_dir}/base/files/dir_reader_posix.h"
        "${target_dir}/base/files/file.h"
        "${target_dir}/base/files/file_descriptor_watcher_posix.h"
        "${target_dir}/base/files/file_enumerator.h"
        "${target_dir}/base/files/file_path.h"
        "${target_dir}/base/files/file_path_watcher.h"
        "${target_dir}/base/files/file_tracing.h"
        "${target_dir}/base/files/file_util.h"
        "${target_dir}/base/files/important_file_writer.h"
        "${target_dir}/base/files/memory_mapped_file.h"
        "${target_dir}/base/files/platform_file.h"
        "${target_dir}/base/files/scoped_file.h"
        "${target_dir}/base/files/scoped_temp_dir.h"
        "${target_dir}/base/format_macros.h"
        "${target_dir}/base/functional/bind.h"
        "${target_dir}/base/functional/callback.h"
        "${target_dir}/base/functional/callback_forward.h"
        "${target_dir}/base/functional/callback_helpers.h"
        "${target_dir}/base/gtest_prod_util.h"
        "${target_dir}/base/guid.h"
        "${target_dir}/base/hash.h"
        "${target_dir}/base/i18n/base_i18n_export.h"
        "${target_dir}/base/i18n/rtl.h"
        "${target_dir}/base/json/json_file_value_serializer.h"
        "${target_dir}/base/json/json_parser.h"
        "${target_dir}/base/json/json_reader.h"
        "${target_dir}/base/json/json_string_value_serializer.h"
        "${target_dir}/base/json/json_value_converter.h"
        "${target_dir}/base/json/json_writer.h"
        "${target_dir}/base/json/string_escape.h"
        "${target_dir}/base/lazy_instance.h"
        "${target_dir}/base/lazy_instance_helpers.h"
        "${target_dir}/base/location.h"
        "${target_dir}/base/logging.h"
        "${target_dir}/base/macros.h"
        "${target_dir}/base/md5.h"
        "${target_dir}/base/memory/aligned_memory.h"
        "${target_dir}/base/memory/free_deleter.h"
        "${target_dir}/base/memory/linked_ptr.h"
        "${target_dir}/base/memory/platform_shared_memory_region.h"
        "${target_dir}/base/memory/protected_memory.h"
        "${target_dir}/base/memory/protected_memory_buildflags.h"
        "${target_dir}/base/memory/protected_memory_cfi.h"
        "${target_dir}/base/memory/ptr_util.h"
        "${target_dir}/base/memory/raw_scoped_refptr_mismatch_checker.h"
        "${target_dir}/base/memory/read_only_shared_memory_region.h"
        "${target_dir}/base/memory/ref_counted.h"
        "${target_dir}/base/memory/ref_counted_delete_on_sequence.h"
        "${target_dir}/base/memory/ref_counted_memory.h"
        "${target_dir}/base/memory/scoped_policy.h"
        "${target_dir}/base/memory/scoped_refptr.h"
        "${target_dir}/base/memory/shared_memory.h"
        "${target_dir}/base/memory/shared_memory_handle.h"
        "${target_dir}/base/memory/shared_memory_helper.h"
        "${target_dir}/base/memory/shared_memory_mapping.h"
        "${target_dir}/base/memory/singleton.h"
        "${target_dir}/base/memory/unsafe_shared_memory_region.h"
        "${target_dir}/base/memory/weak_ptr.h"
        "${target_dir}/base/memory/writable_shared_memory_region.h"
        "${target_dir}/base/message_loop/incoming_task_queue.h"
        "${target_dir}/base/message_loop/message_loop.h"
        "${target_dir}/base/message_loop/message_loop_current.h"
        "${target_dir}/base/message_loop/message_loop_task_runner.h"
        "${target_dir}/base/message_loop/message_pump.h"
        "${target_dir}/base/message_loop/message_pump_default.h"
        "${target_dir}/base/message_loop/message_pump_for_io.h"
        "${target_dir}/base/message_loop/message_pump_for_ui.h"
        "${target_dir}/base/message_loop/message_pump_glib.h"
        "${target_dir}/base/message_loop/message_pump_libevent.h"
        "${target_dir}/base/message_loop/timer_slack.h"
        "${target_dir}/base/message_loop/watchable_io_message_pump_posix.h"
        "${target_dir}/base/metrics/bucket_ranges.h"
        "${target_dir}/base/metrics/dummy_histogram.h"
        "${target_dir}/base/metrics/field_trial.h"
        "${target_dir}/base/metrics/field_trial_param_associator.h"
        "${target_dir}/base/metrics/field_trial_params.h"
        "${target_dir}/base/metrics/histogram.h"
        "${target_dir}/base/metrics/histogram_base.h"
        "${target_dir}/base/metrics/histogram_delta_serialization.h"
        "${target_dir}/base/metrics/histogram_flattener.h"
        "${target_dir}/base/metrics/histogram_functions.h"
        "${target_dir}/base/metrics/histogram_macros.h"
        "${target_dir}/base/metrics/histogram_macros_internal.h"
        "${target_dir}/base/metrics/histogram_macros_local.h"
        "${target_dir}/base/metrics/histogram_samples.h"
        "${target_dir}/base/metrics/histogram_snapshot_manager.h"
        "${target_dir}/base/metrics/metrics_hashes.h"
        "${target_dir}/base/metrics/persistent_histogram_allocator.h"
        "${target_dir}/base/metrics/persistent_histogram_storage.h"
        "${target_dir}/base/metrics/persistent_memory_allocator.h"
        "${target_dir}/base/metrics/persistent_sample_map.h"
        "${target_dir}/base/metrics/record_histogram_checker.h"
        "${target_dir}/base/metrics/sample_map.h"
        "${target_dir}/base/metrics/sample_vector.h"
        "${target_dir}/base/metrics/single_sample_metrics.h"
        "${target_dir}/base/metrics/sparse_histogram.h"
        "${target_dir}/base/metrics/statistics_recorder.h"
        "${target_dir}/base/metrics/user_metrics.h"
        "${target_dir}/base/metrics/user_metrics_action.h"
        "${target_dir}/base/native_library.h"
        "${target_dir}/base/no_destructor.h"
        "${target_dir}/base/numerics/checked_math.h"
        "${target_dir}/base/numerics/checked_math_impl.h"
        "${target_dir}/base/numerics/clamped_math.h"
        "${target_dir}/base/numerics/clamped_math_impl.h"
        "${target_dir}/base/numerics/math_constants.h"
        "${target_dir}/base/numerics/ranges.h"
        "${target_dir}/base/numerics/safe_conversions.h"
        "${target_dir}/base/numerics/safe_conversions_arm_impl.h"
        "${target_dir}/base/numerics/safe_conversions_impl.h"
        "${target_dir}/base/numerics/safe_math.h"
        "${target_dir}/base/numerics/safe_math_arm_impl.h"
        "${target_dir}/base/numerics/safe_math_clang_gcc_impl.h"
        "${target_dir}/base/numerics/safe_math_shared_impl.h"
        "${target_dir}/base/observer_list.h"
        "${target_dir}/base/observer_list_threadsafe.h"
        "${target_dir}/base/optional.h"
        "${target_dir}/base/os_compat_android.h"
        "${target_dir}/base/path_service.h"
        "${target_dir}/base/pending_task.h"
        "${target_dir}/base/pickle.h"
        "${target_dir}/base/posix/eintr_wrapper.h"
        "${target_dir}/base/posix/file_descriptor_shuffle.h"
        "${target_dir}/base/posix/global_descriptors.h"
        "${target_dir}/base/posix/safe_strerror.h"
        "${target_dir}/base/posix/unix_domain_socket.h"
        "${target_dir}/base/post_task_and_reply_with_result_internal.h"
        "${target_dir}/base/power_monitor/power_monitor.h"
        "${target_dir}/base/power_monitor/power_monitor_device_source.h"
        "${target_dir}/base/power_monitor/power_monitor_source.h"
        "${target_dir}/base/power_monitor/power_observer.h"
        "${target_dir}/base/process/internal_aix.h"
        "${target_dir}/base/process/internal_linux.h"
        "${target_dir}/base/process/kill.h"
        "${target_dir}/base/process/launch.h"
        "${target_dir}/base/process/memory.h"
        "${target_dir}/base/process/process.h"
        "${target_dir}/base/process/process_handle.h"
        "${target_dir}/base/process/process_info.h"
        "${target_dir}/base/process/process_iterator.h"
        "${target_dir}/base/process/process_metrics.h"
        "${target_dir}/base/process/process_metrics_iocounters.h"
        "${target_dir}/base/rand_util.h"
        "${target_dir}/base/run_loop.h"
        "${target_dir}/base/sampling_heap_profiler/lock_free_address_hash_set.h"
        "${target_dir}/base/sampling_heap_profiler/sampling_heap_profiler.h"
        "${target_dir}/base/scoped_clear_errno.h"
        "${target_dir}/base/scoped_generic.h"
        "${target_dir}/base/scoped_native_library.h"
        "${target_dir}/base/scoped_observer.h"
        "${target_dir}/base/sequence_checker.h"
        "${target_dir}/base/sequence_checker_impl.h"
        "${target_dir}/base/sequence_token.h"
        "${target_dir}/base/sequenced_task_runner.h"
        "${target_dir}/base/sequenced_task_runner_helpers.h"
        "${target_dir}/base/sha1.h"
        "${target_dir}/base/single_thread_task_runner.h"
        "${target_dir}/base/stl_util.h"
        "${target_dir}/base/strings/char_traits.h"
        "${target_dir}/base/strings/nullable_string16.h"
        "${target_dir}/base/strings/old_utf_string_conversions.h"
        "${target_dir}/base/strings/pattern.h"
        "${target_dir}/base/strings/safe_sprintf.h"
        "${target_dir}/base/strings/strcat.h"
        "${target_dir}/base/strings/string16.h"
        "${target_dir}/base/strings/string_number_conversions.h"
        "${target_dir}/base/strings/string_piece.h"
        "${target_dir}/base/strings/string_piece_forward.h"
        "${target_dir}/base/strings/string_split.h"
        "${target_dir}/base/strings/string_tokenizer.h"
        "${target_dir}/base/strings/string_util.h"
        "${target_dir}/base/strings/string_util_posix.h"
        "${target_dir}/base/strings/stringize_macros.h"
        "${target_dir}/base/strings/stringprintf.h"
        "${target_dir}/base/strings/sys_string_conversions.h"
        "${target_dir}/base/strings/utf_string_conversion_utils.h"
        "${target_dir}/base/strings/utf_string_conversions.h"
        "${target_dir}/base/sync_socket.h"
        "${target_dir}/base/synchronization/atomic_flag.h"
        "${target_dir}/base/synchronization/cancellation_flag.h"
        "${target_dir}/base/synchronization/condition_variable.h"
        "${target_dir}/base/synchronization/lock.h"
        "${target_dir}/base/synchronization/lock_impl.h"
        "${target_dir}/base/synchronization/spin_wait.h"
        "${target_dir}/base/synchronization/synchronization_buildflags.h"
        "${target_dir}/base/synchronization/waitable_event.h"
        "${target_dir}/base/synchronization/waitable_event_watcher.h"
        "${target_dir}/base/sys_byteorder.h"
        "${target_dir}/base/sys_info.h"
        "${target_dir}/base/sys_info_internal.h"
        "${target_dir}/base/task/cancelable_task_tracker.h"
        "${target_dir}/base/task/sequence_manager/enqueue_order.h"
        "${target_dir}/base/task/sequence_manager/graceful_queue_shutdown_helper.h"
        "${target_dir}/base/task/sequence_manager/intrusive_heap.h"
        "${target_dir}/base/task/sequence_manager/lazily_deallocated_deque.h"
        "${target_dir}/base/task/sequence_manager/lazy_now.h"
        "${target_dir}/base/task/sequence_manager/moveable_auto_lock.h"
        "${target_dir}/base/task/sequence_manager/real_time_domain.h"
        "${target_dir}/base/task/sequence_manager/sequence_manager.h"
        "${target_dir}/base/task/sequence_manager/sequence_manager_impl.h"
        "${target_dir}/base/task/sequence_manager/sequenced_task_source.h"
        "${target_dir}/base/task/sequence_manager/task_queue.h"
        "${target_dir}/base/task/sequence_manager/task_queue_impl.h"
        "${target_dir}/base/task/sequence_manager/task_queue_selector.h"
        "${target_dir}/base/task/sequence_manager/task_queue_selector_logic.h"
        "${target_dir}/base/task/sequence_manager/task_time_observer.h"
        "${target_dir}/base/task/sequence_manager/test/fake_task.h"
        "${target_dir}/base/task/sequence_manager/test/lazy_thread_controller_for_test.h"
        "${target_dir}/base/task/sequence_manager/test/mock_time_domain.h"
        "${target_dir}/base/task/sequence_manager/test/sequence_manager_for_test.h"
        "${target_dir}/base/task/sequence_manager/test/test_task_queue.h"
        "${target_dir}/base/task/sequence_manager/test/test_task_time_observer.h"
        "${target_dir}/base/task/sequence_manager/thread_controller.h"
        "${target_dir}/base/task/sequence_manager/thread_controller_impl.h"
        "${target_dir}/base/task/sequence_manager/thread_controller_with_message_pump_impl.h"
        "${target_dir}/base/task/sequence_manager/time_domain.h"
        "${target_dir}/base/task/sequence_manager/work_queue.h"
        "${target_dir}/base/task/sequence_manager/work_queue_sets.h"
        "${target_dir}/base/task_runner.h"
        "${target_dir}/base/task_runner_util.h"
        "${target_dir}/base/task_scheduler/can_schedule_sequence_observer.h"
        "${target_dir}/base/task_scheduler/delayed_task_manager.h"
        "${target_dir}/base/task_scheduler/environment_config.h"
        "${target_dir}/base/task_scheduler/lazy_task_runner.h"
        "${target_dir}/base/task_scheduler/post_task.h"
        "${target_dir}/base/task_scheduler/priority_queue.h"
        "${target_dir}/base/task_scheduler/scheduler_lock.h"
        "${target_dir}/base/task_scheduler/scheduler_lock_impl.h"
        "${target_dir}/base/task_scheduler/scheduler_single_thread_task_runner_manager.h"
        "${target_dir}/base/task_scheduler/scheduler_worker.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_observer.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_params.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_pool.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_pool_impl.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_pool_params.h"
        "${target_dir}/base/task_scheduler/scheduler_worker_stack.h"
        "${target_dir}/base/task_scheduler/scoped_set_task_priority_for_current_thread.h"
        "${target_dir}/base/task_scheduler/sequence.h"
        "${target_dir}/base/task_scheduler/sequence_sort_key.h"
        "${target_dir}/base/task_scheduler/service_thread.h"
        "${target_dir}/base/task_scheduler/single_thread_task_runner_thread_mode.h"
        "${target_dir}/base/task_scheduler/task.h"
        "${target_dir}/base/task_scheduler/task_scheduler.h"
        "${target_dir}/base/task_scheduler/task_scheduler_impl.h"
        "${target_dir}/base/task_scheduler/task_tracker.h"
        "${target_dir}/base/task_scheduler/task_tracker_posix.h"
        "${target_dir}/base/task_scheduler/task_traits.h"
        "${target_dir}/base/task_scheduler/task_traits_details.h"
        "${target_dir}/base/task_scheduler/test_utils.h"
        "${target_dir}/base/task_scheduler/tracked_ref.h"
        "${target_dir}/base/template_util.h"
        "${target_dir}/base/test/bind_test_util.h"
        "${target_dir}/base/test/copy_only_int.h"
        "${target_dir}/base/test/fontconfig_util_linux.h"
        "${target_dir}/base/test/gtest_util.h"
        "${target_dir}/base/test/metrics/histogram_enum_reader.h"
        "${target_dir}/base/test/metrics/histogram_tester.h"
        "${target_dir}/base/test/mock_entropy_provider.h"
        "${target_dir}/base/test/move_only_int.h"
        "${target_dir}/base/test/multiprocess_test.h"
        "${target_dir}/base/test/scoped_environment_variable_override.h"
        "${target_dir}/base/test/scoped_feature_list.h"
        "${target_dir}/base/test/scoped_locale.h"
        "${target_dir}/base/test/scoped_task_environment.h"
        "${target_dir}/base/test/simple_test_clock.h"
        "${target_dir}/base/test/simple_test_tick_clock.h"
        "${target_dir}/base/test/test_file_util.h"
        "${target_dir}/base/test/test_io_thread.h"
        "${target_dir}/base/test/test_mock_time_task_runner.h"
        "${target_dir}/base/test/test_pending_task.h"
        "${target_dir}/base/test/test_shared_memory_util.h"
        "${target_dir}/base/test/test_simple_task_runner.h"
        "${target_dir}/base/test/test_switches.h"
        "${target_dir}/base/test/test_timeouts.h"
        "${target_dir}/base/third_party/dynamic_annotations/dynamic_annotations.h"
        "${target_dir}/base/third_party/icu/icu_utf.h"
        "${target_dir}/base/third_party/libevent/event.h"
        "${target_dir}/base/third_party/nspr/prtime.h"
        "${target_dir}/base/third_party/symbolize/symbolize.h"
        "${target_dir}/base/third_party/valgrind/memcheck.h"
        "${target_dir}/base/third_party/valgrind/valgrind.h"
        "${target_dir}/base/thread_annotations.h"
        "${target_dir}/base/threading/platform_thread.h"
        "${target_dir}/base/threading/platform_thread_internal_posix.h"
        "${target_dir}/base/threading/post_task_and_reply_impl.h"
        "${target_dir}/base/threading/scoped_blocking_call.h"
        "${target_dir}/base/threading/sequence_local_storage_map.h"
        "${target_dir}/base/threading/sequence_local_storage_slot.h"
        "${target_dir}/base/threading/sequenced_task_runner_handle.h"
        "${target_dir}/base/threading/simple_thread.h"
        "${target_dir}/base/threading/thread.h"
        "${target_dir}/base/threading/thread_checker.h"
        "${target_dir}/base/threading/thread_checker_impl.h"
        "${target_dir}/base/threading/thread_collision_warner.h"
        "${target_dir}/base/threading/thread_id_name_manager.h"
        "${target_dir}/base/threading/thread_local.h"
        "${target_dir}/base/threading/thread_local_storage.h"
        "${target_dir}/base/threading/thread_restrictions.h"
        "${target_dir}/base/threading/thread_task_runner_handle.h"
        "${target_dir}/base/time/clock.h"
        "${target_dir}/base/time/default_clock.h"
        "${target_dir}/base/time/default_tick_clock.h"
        "${target_dir}/base/time/tick_clock.h"
        "${target_dir}/base/time/time.h"
        "${target_dir}/base/time/time_override.h"
        "${target_dir}/base/time/time_to_iso8601.h"
        "${target_dir}/base/timer/elapsed_timer.h"
        "${target_dir}/base/timer/hi_res_timer_manager.h"
        "${target_dir}/base/timer/mock_timer.h"
        "${target_dir}/base/timer/timer.h"
        "${target_dir}/base/token.h"
        "${target_dir}/base/trace_event/common/trace_event_common.h"
        "${target_dir}/base/trace_event/heap_profiler.h"
        "${target_dir}/base/trace_event/trace_event.h"
        "${target_dir}/base/tuple.h"
        "${target_dir}/base/unguessable_token.h"
        "${target_dir}/base/value_iterators.h"
        "${target_dir}/base/values.h"
        "${target_dir}/base/version.h"
        "${target_dir}/base/vlog.h"
        "${target_dir}/build/build_config.h"
        "${target_dir}/build/buildflag.h"
        "${target_dir}/device/bluetooth/bluetooth_advertisement.h"
        "${target_dir}/device/bluetooth/bluetooth_common.h"
        "${target_dir}/device/bluetooth/bluetooth_export.h"
        "${target_dir}/device/bluetooth/bluetooth_uuid.h"
        "${target_dir}/device/bluetooth/bluez/bluetooth_service_attribute_value_bluez.h"
        "${target_dir}/testing/gmock/include/gmock/gmock.h"
        "${target_dir}/testing/gtest/include/gtest/gtest.h"
        "${target_dir}/testing/gtest/include/gtest/gtest_prod.h"
        "${target_dir}/testing/multiprocess_func_list.h"
        "${target_dir}/testing/platform_test.h"
        "${target_dir}/third_party/ashmem/ashmem.h"
        "${target_dir}/third_party/modp_b64/modp_b64.h"
        "${target_dir}/third_party/protobuf/src/google/protobuf/message_lite.h"
        "${target_dir}/third_party/re2/src/re2/re2.h"
        "${target_dir}/ui/gfx/geometry/insets.h"
        "${target_dir}/ui/gfx/geometry/insets_f.h"
        "${target_dir}/ui/gfx/geometry/mojo/geometry_struct_traits.h"
        "${target_dir}/ui/gfx/geometry/point.h"
        "${target_dir}/ui/gfx/geometry/point_conversions.h"
        "${target_dir}/ui/gfx/geometry/point_f.h"
        "${target_dir}/ui/gfx/geometry/rect.h"
        "${target_dir}/ui/gfx/geometry/rect_f.h"
        "${target_dir}/ui/gfx/geometry/safe_integer_conversions.h"
        "${target_dir}/ui/gfx/geometry/scroll_offset.h"
        "${target_dir}/ui/gfx/geometry/size.h"
        "${target_dir}/ui/gfx/geometry/size_conversions.h"
        "${target_dir}/ui/gfx/geometry/size_f.h"
        "${target_dir}/ui/gfx/geometry/vector2d.h"
        "${target_dir}/ui/gfx/geometry/vector2d_f.h"
        "${target_dir}/ui/gfx/gfx_export.h"
        "${target_dir}/ui/gfx/range/gfx_range_export.h"
        "${target_dir}/ui/gfx/range/mojo/range_struct_traits.h"
        "${target_dir}/ui/gfx/range/range.h"
        "${target_dir}/ui/gfx/range/range_f.h"
)

set(libchrome_defaults_cflags
        "-Wall"
        "-Werror"
        "-Wno-deprecated-declarations"
        "-Wno-implicit-fallthrough"
        "-Wno-implicit-int-float-conversion"
        ## memory_mapped_file.cc:80, json_parser.cc:264,
        ## sys_string_conversions_posix.cc:122, and
        ## icu_utf.cc:161,165 have -Wno-implicit-fallthrough.
        "-Wno-missing-field-initializers"
        "-Wno-unused-parameter"
        "-Wno-nonnull" # clang 21
)

if(NOT CMAKE_SYSTEM_NAME STREQUAL "Android")
    list(APPEND libchrome_defaults_cflags 
        "-D__ANDROID_HOST__"
        "-DDONT_EMBED_BUILD_METADATA"
    )
endif()

if(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
    list(APPEND libchrome_defaults_cflags "-Wno-vla-cxx-extension")
endif()

set(libchromeCommonSrc
    "${target_dir}/base/at_exit.cc"
    "${target_dir}/base/barrier_closure.cc"
    "${target_dir}/base/base64.cc"
    "${target_dir}/base/base64url.cc"
    "${target_dir}/base/base_paths.cc"
    "${target_dir}/base/base_paths_posix.cc"
    "${target_dir}/base/base_switches.cc"
    "${target_dir}/base/big_endian.cc"
    "${target_dir}/base/build_time.cc"
    "${target_dir}/base/callback_helpers.cc"
    "${target_dir}/base/callback_internal.cc"
    "${target_dir}/base/command_line.cc"
    "${target_dir}/base/cpu.cc"
    "${target_dir}/base/debug/activity_tracker.cc"
    "${target_dir}/base/debug/alias.cc"
    "${target_dir}/base/debug/crash_logging.cc"
    "${target_dir}/base/debug/debugger.cc"
    "${target_dir}/base/debug/debugger_posix.cc"
    "${target_dir}/base/debug/dump_without_crashing.cc"
    "${target_dir}/base/debug/proc_maps_linux.cc"
    "${target_dir}/base/debug/profiler.cc"
    "${target_dir}/base/debug/stack_trace.cc"
    "${target_dir}/base/debug/task_annotator.cc"
    "${target_dir}/base/environment.cc"
    "${target_dir}/base/feature_list.cc"
    "${target_dir}/base/files/file.cc"
    "${target_dir}/base/files/file_descriptor_watcher_posix.cc"
    "${target_dir}/base/files/file_enumerator.cc"
    "${target_dir}/base/files/file_enumerator_posix.cc"
    "${target_dir}/base/files/file_path.cc"
    "${target_dir}/base/files/file_path_constants.cc"
    "${target_dir}/base/files/file_path_watcher.cc"
    "${target_dir}/base/files/file_posix.cc"
    "${target_dir}/base/files/file_tracing.cc"
    "${target_dir}/base/files/file_util.cc"
    "${target_dir}/base/files/file_util_posix.cc"
    "${target_dir}/base/files/important_file_writer.cc"
    "${target_dir}/base/files/memory_mapped_file.cc"
    "${target_dir}/base/files/memory_mapped_file_posix.cc"
    "${target_dir}/base/files/scoped_file.cc"
    "${target_dir}/base/files/scoped_temp_dir.cc"
    "${target_dir}/base/guid.cc"
    "${target_dir}/base/hash.cc"
    "${target_dir}/base/json/json_file_value_serializer.cc"
    "${target_dir}/base/json/json_parser.cc"
    "${target_dir}/base/json/json_reader.cc"
    "${target_dir}/base/json/json_string_value_serializer.cc"
    "${target_dir}/base/json/json_value_converter.cc"
    "${target_dir}/base/json/json_writer.cc"
    "${target_dir}/base/json/string_escape.cc"
    "${target_dir}/base/lazy_instance_helpers.cc"
    "${target_dir}/base/location.cc"
    "${target_dir}/base/logging.cc"
    "${target_dir}/base/md5.cc"
    "${target_dir}/base/memory/aligned_memory.cc"
    "${target_dir}/base/memory/platform_shared_memory_region.cc"
    "${target_dir}/base/memory/read_only_shared_memory_region.cc"
    "${target_dir}/base/memory/ref_counted.cc"
    "${target_dir}/base/memory/ref_counted_memory.cc"
    "${target_dir}/base/memory/shared_memory_handle.cc"
    "${target_dir}/base/memory/shared_memory_helper.cc"
    "${target_dir}/base/memory/shared_memory_mapping.cc"
    "${target_dir}/base/memory/unsafe_shared_memory_region.cc"
    "${target_dir}/base/memory/weak_ptr.cc"
    "${target_dir}/base/memory/writable_shared_memory_region.cc"
    "${target_dir}/base/message_loop/incoming_task_queue.cc"
    "${target_dir}/base/message_loop/message_loop.cc"
    "${target_dir}/base/message_loop/message_loop_current.cc"
    "${target_dir}/base/message_loop/message_loop_task_runner.cc"
    "${target_dir}/base/message_loop/message_pump.cc"
    "${target_dir}/base/message_loop/message_pump_default.cc"
    "${target_dir}/base/message_loop/message_pump_libevent.cc"
    "${target_dir}/base/message_loop/watchable_io_message_pump_posix.cc"
    "${target_dir}/base/metrics/bucket_ranges.cc"
    "${target_dir}/base/metrics/dummy_histogram.cc"
    "${target_dir}/base/metrics/field_trial.cc"
    "${target_dir}/base/metrics/field_trial_param_associator.cc"
    "${target_dir}/base/metrics/histogram.cc"
    "${target_dir}/base/metrics/histogram_base.cc"
    "${target_dir}/base/metrics/histogram_functions.cc"
    "${target_dir}/base/metrics/histogram_samples.cc"
    "${target_dir}/base/metrics/histogram_snapshot_manager.cc"
    "${target_dir}/base/metrics/metrics_hashes.cc"
    "${target_dir}/base/metrics/persistent_histogram_allocator.cc"
    "${target_dir}/base/metrics/persistent_memory_allocator.cc"
    "${target_dir}/base/metrics/persistent_sample_map.cc"
    "${target_dir}/base/metrics/sample_map.cc"
    "${target_dir}/base/metrics/sample_vector.cc"
    "${target_dir}/base/metrics/sparse_histogram.cc"
    "${target_dir}/base/metrics/statistics_recorder.cc"
    "${target_dir}/base/native_library.cc"
    "${target_dir}/base/native_library_posix.cc"
    "${target_dir}/base/observer_list_threadsafe.cc"
    "${target_dir}/base/path_service.cc"
    "${target_dir}/base/pending_task.cc"
    "${target_dir}/base/pickle.cc"
    "${target_dir}/base/posix/file_descriptor_shuffle.cc"
    "${target_dir}/base/posix/global_descriptors.cc"
    "${target_dir}/base/posix/safe_strerror.cc"
    "${target_dir}/base/process/kill.cc"
    "${target_dir}/base/process/kill_posix.cc"
    "${target_dir}/base/process/launch.cc"
    "${target_dir}/base/process/launch_posix.cc"
    "${target_dir}/base/process/memory.cc"
    "${target_dir}/base/process/process_handle.cc"
    "${target_dir}/base/process/process_handle_posix.cc"
    "${target_dir}/base/process/process_iterator.cc"
    "${target_dir}/base/process/process_metrics.cc"
    "${target_dir}/base/process/process_metrics_posix.cc"
    "${target_dir}/base/process/process_posix.cc"
    "${target_dir}/base/rand_util.cc"
    "${target_dir}/base/rand_util_posix.cc"
    "${target_dir}/base/run_loop.cc"
    "${target_dir}/base/scoped_native_library.cc"
    "${target_dir}/base/sequence_checker_impl.cc"
    "${target_dir}/base/sequence_token.cc"
    "${target_dir}/base/sequenced_task_runner.cc"
    "${target_dir}/base/sha1.cc"
    "${target_dir}/base/strings/nullable_string16.cc"
    "${target_dir}/base/strings/pattern.cc"
    "${target_dir}/base/strings/safe_sprintf.cc"
    "${target_dir}/base/strings/strcat.cc"
    "${target_dir}/base/strings/string16.cc"
    "${target_dir}/base/strings/string_number_conversions.cc"
    "${target_dir}/base/strings/string_piece.cc"
    "${target_dir}/base/strings/string_split.cc"
    "${target_dir}/base/strings/string_util.cc"
    "${target_dir}/base/strings/string_util_constants.cc"
    "${target_dir}/base/strings/stringprintf.cc"
    "${target_dir}/base/strings/utf_string_conversion_utils.cc"
    "${target_dir}/base/strings/utf_string_conversions.cc"
    "${target_dir}/base/sync_socket_posix.cc"
    "${target_dir}/base/synchronization/atomic_flag.cc"
    "${target_dir}/base/synchronization/condition_variable_posix.cc"
    "${target_dir}/base/synchronization/lock.cc"
    "${target_dir}/base/synchronization/lock_impl_posix.cc"
    "${target_dir}/base/synchronization/waitable_event_posix.cc"
    "${target_dir}/base/sys_info.cc"
    "${target_dir}/base/sys_info_posix.cc"
    "${target_dir}/base/task/cancelable_task_tracker.cc"
    "${target_dir}/base/task_runner.cc"
    "${target_dir}/base/task_scheduler/scheduler_lock_impl.cc"
    "${target_dir}/base/task_scheduler/scoped_set_task_priority_for_current_thread.cc"
    "${target_dir}/base/task_scheduler/sequence.cc"
    "${target_dir}/base/task_scheduler/sequence_sort_key.cc"
    "${target_dir}/base/task_scheduler/task.cc"
    "${target_dir}/base/task_scheduler/task_traits.cc"
    "${target_dir}/base/third_party/dynamic_annotations/dynamic_annotations.c"
    "${target_dir}/base/third_party/icu/icu_utf.cc"
    "${target_dir}/base/third_party/nspr/prtime.cc"
    "${target_dir}/base/threading/platform_thread_posix.cc"
    "${target_dir}/base/threading/post_task_and_reply_impl.cc"
    "${target_dir}/base/threading/scoped_blocking_call.cc"
    "${target_dir}/base/threading/sequence_local_storage_map.cc"
    "${target_dir}/base/threading/sequence_local_storage_slot.cc"
    "${target_dir}/base/threading/sequenced_task_runner_handle.cc"
    "${target_dir}/base/threading/simple_thread.cc"
    "${target_dir}/base/threading/thread.cc"
    "${target_dir}/base/threading/thread_checker_impl.cc"
    "${target_dir}/base/threading/thread_collision_warner.cc"
    "${target_dir}/base/threading/thread_id_name_manager.cc"
    "${target_dir}/base/threading/thread_local_storage.cc"
    "${target_dir}/base/threading/thread_local_storage_posix.cc"
    "${target_dir}/base/threading/thread_restrictions.cc"
    "${target_dir}/base/threading/thread_task_runner_handle.cc"
    "${target_dir}/base/time/clock.cc"
    "${target_dir}/base/time/default_clock.cc"
    "${target_dir}/base/time/default_tick_clock.cc"
    "${target_dir}/base/time/tick_clock.cc"
    "${target_dir}/base/time/time.cc"
    "${target_dir}/base/time/time_conversion_posix.cc"
    "${target_dir}/base/time/time_exploded_posix.cc"
    "${target_dir}/base/time/time_now_posix.cc"
    "${target_dir}/base/time/time_override.cc"
    "${target_dir}/base/timer/elapsed_timer.cc"
    "${target_dir}/base/timer/timer.cc"
    "${target_dir}/base/token.cc"
    "${target_dir}/base/unguessable_token.cc"
    "${target_dir}/base/value_iterators.cc"
    "${target_dir}/base/values.cc"
    "${target_dir}/base/version.cc"
    "${target_dir}/base/vlog.cc"
    "${target_dir}/device/bluetooth/bluetooth_advertisement.cc"
    "${target_dir}/device/bluetooth/bluetooth_uuid.cc"
    "${target_dir}/device/bluetooth/bluez/bluetooth_service_attribute_value_bluez.cc"
    "${target_dir}/ui/gfx/geometry/insets.cc"
    "${target_dir}/ui/gfx/geometry/insets_f.cc"
    "${target_dir}/ui/gfx/geometry/point.cc"
    "${target_dir}/ui/gfx/geometry/point_conversions.cc"
    "${target_dir}/ui/gfx/geometry/point_f.cc"
    "${target_dir}/ui/gfx/geometry/rect.cc"
    "${target_dir}/ui/gfx/geometry/rect_f.cc"
    "${target_dir}/ui/gfx/geometry/size.cc"
    "${target_dir}/ui/gfx/geometry/size_conversions.cc"
    "${target_dir}/ui/gfx/geometry/size_f.cc"
    "${target_dir}/ui/gfx/geometry/vector2d.cc"
    "${target_dir}/ui/gfx/geometry/vector2d_f.cc"
    "${target_dir}/ui/gfx/range/range.cc"
    "${target_dir}/ui/gfx/range/range_f.cc"
)

set(libchromeLinuxSrc
    "${target_dir}/base/files/file_path_watcher_linux.cc"
    "${target_dir}/base/files/file_util_linux.cc"
    "${target_dir}/base/memory/shared_memory_posix.cc"
    "${target_dir}/base/posix/unix_domain_socket.cc"
    "${target_dir}/base/process/internal_linux.cc"
    #"${target_dir}/base/process/memory_linux.cc"
    "${target_dir}/base/process/process_handle_linux.cc"
    "${target_dir}/base/process/process_info_linux.cc"
    "${target_dir}/base/process/process_iterator_linux.cc"
    "${target_dir}/base/process/process_metrics_linux.cc"
    "${target_dir}/base/strings/sys_string_conversions_posix.cc"
    "${target_dir}/base/sys_info_linux.cc"
    "${target_dir}/base/threading/platform_thread_internal_posix.cc"
    "${target_dir}/base/threading/platform_thread_linux.cc"
)

set(libchromeMuslSrc
    "${target_dir}/base/debug/stack_trace_posix.cc"
    "${target_dir}/base/memory/platform_shared_memory_region_posix.cc"
    "${target_dir}/base/memory/shared_memory_handle_posix.cc"
)

set(libchromeGlibcSrc
    "${target_dir}/base/allocator/allocator_shim.cc"
    "${target_dir}/base/allocator/allocator_shim_default_dispatch_to_glibc.cc"
    "${target_dir}/base/debug/stack_trace_posix.cc"
    "${target_dir}/base/memory/platform_shared_memory_region_posix.cc"
    "${target_dir}/base/memory/shared_memory_handle_posix.cc"
)

set(libchromeLinuxBionicSrc # NDK
    "${target_dir}/base/debug/stack_trace_android.cc"
    "${target_dir}/base/memory/platform_shared_memory_region_posix.cc"
    "${target_dir}/base/memory/shared_memory_handle_posix.cc"
)

set(libchromeAndroidSrc
    "${target_dir}/base/android/android_hardware_buffer_compat.cc"
    "${target_dir}/base/android/build_info.cc"
    "${target_dir}/base/android/content_uri_utils.cc"
    "${target_dir}/base/android/java_exception_reporter.cc"
    "${target_dir}/base/android/jni_android.cc"
    "${target_dir}/base/android/jni_array.cc"
    "${target_dir}/base/android/jni_string.cc"
    "${target_dir}/base/android/path_utils.cc"
    "${target_dir}/base/android/scoped_java_ref.cc"
    "${target_dir}/base/android/scoped_hardware_buffer_handle.cc"
    "${target_dir}/base/android/sys_utils.cc"
    "${target_dir}/base/base_paths_android.cc"
    "${target_dir}/base/debug/stack_trace_android.cc"
    "${target_dir}/base/memory/platform_shared_memory_region_android.cc"
    "${target_dir}/base/memory/shared_memory_android.cc"
    "${target_dir}/base/memory/shared_memory_handle_android.cc"
    "${target_dir}/base/os_compat_android.cc"
    "${target_dir}/base/sys_info_android.cc"
    "${target_dir}/base/time/time_android.cc"
)

set(target_srcs
    ${libchromeCommonSrc}
)

if(NOT (HAVE_GLIBC OR HAVE_BIONIC OR HAVE_MUSL))
    message(STATUS "No libc detected, defaulting to GLIBC for Linux")
    if(CMAKE_SYSTEM_NAME STREQUAL "Linux" AND NOT CMAKE_SYSTEM_NAME STREQUAL "Android")
        set(HAVE_GLIBC 1)
    elseif(CMAKE_SYSTEM_NAME STREQUAL "Android")
        set(HAVE_BIONIC 1)
    else()
        message(FATAL_ERROR "Please specify libc: -DHAVE_GLIBC=1 or -DHAVE_MUSL=1 or -DHAVE_BIONIC=1")
    endif()
endif()

message(STATUS "HAVE_BIONIC: ${HAVE_BIONIC}")
message(STATUS "HAVE_GLIBC: ${HAVE_GLIBC}")
message(STATUS "HAVE_MUSL: ${HAVE_MUSL}")

if(CMAKE_SYSTEM_NAME MATCHES "Linux|Android")
    message(STATUS "libchrome use Linux sources")
    list(APPEND target_srcs
        ${libchromeLinuxSrc}
    )
endif()

if(HAVE_BIONIC)
    message(STATUS "libchrome use bionic sources")
    list(APPEND target_srcs
        ${libchromeLinuxBionicSrc}
    )
endif()

if(HAVE_GLIBC)
    message(STATUS "libchrome use glibc sources")
    list(APPEND libchrome_defaults_cflags "-fno-exceptions")
    list(APPEND libchrome_defaults_cflags "-DDISABLE_ALLOCATOR_SHIM")
    
    list(REMOVE_ITEM libchromeGlibcSrc 
        "${target_dir}/base/allocator/allocator_shim.cc"
    )
    list(APPEND target_srcs
        ${libchromeGlibcSrc}
    )
endif()

if(HAVE_MUSL)
    message(STATUS "libchrome use musl sources")
    list(APPEND target_srcs
        ${libchromeMuslSrc}
    )
endif()

# Not need in this project
#if(CMAKE_SYSTEM_NAME STREQUAL "Android")
#    message(STATUS "libchrome with android libs")
#    list(APPEND target_srcs
#        ${libchromeAndroidSrc}
#    )
#endif()

# Generate headers
foreach(file ${libchrome_include_sources})
    string(REPLACE "${target_dir}/" "" relative_file ${file})
    add_custom_command(
        OUTPUT ${CMAKE_BINARY_DIR}/libchrome_includes/${relative_file}
        COMMAND ${CMAKE_COMMAND} -E copy
                ${file}
                ${CMAKE_BINARY_DIR}/libchrome_includes/${relative_file}
        DEPENDS ${file}
    )
    list(APPEND ALL_COPIED_FILES ${CMAKE_BINARY_DIR}/libchrome_includes/${relative_file})
endforeach()

add_custom_target(copy_all_files ALL
    DEPENDS ${ALL_COPIED_FILES}
)

add_library(${target} STATIC ${target_srcs})
add_dependencies(${target} copy_all_files)
target_compile_options(${target} PUBLIC ${libchrome_defaults_cflags})
target_link_libraries(${target} PRIVATE base event modpb64 PUBLIC gtest)
target_include_directories(${target} PUBLIC "${CMAKE_BINARY_DIR}/libchrome_includes")
if(CMAKE_SYSTEM_NAME STREQUAL "Android")
    target_link_libraries(${target} PUBLIC cutils log)
    target_compile_options(${target} PUBLIC -U__ANDROID__)
endif()